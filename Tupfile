TARGET=2d

CFLAGS= -g -std=c11 -Isrc -Ibuild/gen -Itest/$(TARGET)/

!cc = |> clang $(CFLAGS) -c %f -o %o |>
!lucgen = |> lucgen/lucgen.lua %f -o %o -l test/$(TARGET)/config.lua |>

: foreach src/*.luc |> !lucgen |> build/gen/%B.c
: foreach src/*.luh |> !lucgen |> build/gen/%B.h
: foreach src/*.c | build/gen/*.h |> !cc |> build/obj/%B.o
: foreach build/gen/*.c | build/gen/*.h |> !cc |> build/obj/%B.o
